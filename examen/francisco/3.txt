#include <stdio.h>
#include <string.h>

int main(int argc, char *argv[]) {
    FILE *fp;
    char estado[4], nombre[100], version[100], linea[256];
    int encontrado = 0;

    if (argc != 2) {
        printf("Uso: %s paquete\n", argv[0]);
        return 1;
    }

    fp = popen("dpkg -l", "r");
    if (fp == NULL) {
        perror("Error al ejecutar dpkg");
        return 1;
    }

    while (fgets(linea, sizeof(linea), fp)) {
        sscanf(linea, "%3s %99s %99s", estado, nombre, version);
        if (strcmp(estado, "ii") == 0 && strcmp(nombre, argv[1]) == 0) {
            printf("El paquete %s está instalado. Versión: %s\n", nombre, version);
            encontrado = 1;
            break;
        }
    }

    pclose(fp);

    if (!encontrado) {
        printf("El paquete %s no está instalado\n", argv[1]);
    }

    return 0;
}
